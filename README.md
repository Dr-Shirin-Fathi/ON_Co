شرح کار انجام‌شده در کد

بارگذاری داده‌ها
چهار فایل اکسل شامل اطلاعات نسخه‌برداری (Prescribing/Deprescribing) و تعاملات دارویی با ریسک بالا خوانده شدند:

داده‌ی کامل تأثیر دی‌پرِسکریپشن (FULL)

داده‌ی محدود به تعاملات پرخطر نوع X

لیست یال‌ها (Edge list) از تعاملات پرخطر X

فهرست ۱۰ داروی برتر با ریسک X و پتانسیل بالای قطعه‌قطعه کردن شبکه

استخراج کدهای ATC
برای هر دارو کد ATC در سطوح مختلف (حرف اول = Level 1، سه کاراکتر اول = Level 3، چهار کاراکتر اول = Level 4) جدا شد. این کار برای تحلیل گروه‌های درمانی (به‌خصوص داروهای انکولوژی با کد L*) انجام شد.

محاسبه شاخص‌های «Fragmentation» (قطعه‌قطعه شدن شبکه)
برای هر دارو بررسی شد اگر آن دارو حذف شود:

تعداد اجزای جدید شبکه چند تا بیشتر می‌شود.

اندازه مؤلفه اصلی (Giant Component) چقدر کاهش پیدا می‌کند.
سپس هر دو معیار نرمال‌سازی (min–max scaling) شدند و یک شاخص ترکیبی (Frag Index) به‌صورت میانگین وزنی ساخته شد.
این محاسبات هم برای دیتاست کامل (FULL) و هم دیتاست پرخطر X انجام شد.

تمرکز روی داروهای انکولوژی (ATC = L*)
نتایج قبلی فیلتر شدند تا فقط داروهای مربوط به سرطان بررسی شوند. این کار امکان مقایسه مستقیم بین داروهای انکولوژی و سایر داروها را فراهم کرد.

شناسایی داروهای Fragmenter برتر
۲۰ داروی اول با بیشترین Frag Index در کل شبکه و همچنین به طور خاص در داروهای انکولوژی استخراج و ذخیره شدند.

تحلیل گره‌های پرخطر (X-Hubs)
از جدول تعاملات دارویی (Edge List) درجه (Degree) و درجه وزنی (Weighted Degree) برای هر دارو محاسبه شد. این شاخص نشان می‌دهد هر دارو چند شریک تعاملی دارد و مجموع شدت تعاملات آن چقدر است.
بر اساس این شاخص‌ها، داروهای هاب پرخطر شناسایی شدند و برای داروهای انکولوژی نیز به طور خاص بررسی شد.

خلاصه‌سازی گروهی (Oncology vs Non-Oncology)
در نهایت، برای مجموعه X-only، شاخص‌های میانه Fragmentation در دو گروه «داروهای انکولوژی (L*)» و «داروهای غیرانکولوژی» محاسبه و مقایسه شد.

خروجی‌های نهایی (فایل‌های تولیدشده)

top_frag_overall.csv → لیست ۲۰ داروی اول که حذفشان بیشترین قطعه‌قطعه شدن شبکه را ایجاد می‌کند.

top_frag_onc.csv → همان تحلیل فقط برای داروهای انکولوژی (ATC L*).

summary_depresc.csv → جدول خلاصه‌ای از شاخص‌های میانه Fragmentation در داروهای انکولوژی در مقابل داروهای غیرانکولوژی.

این کد امضای شبکه‌ای (Network Signatures) مربوط به تأثیر حذف داروها و هاب‌های پرخطر X را استخراج می‌کند. خروجی نهایی سه فایل است که نشان می‌دهند کدام داروها بیشترین نقش را در قطعه‌قطعه کردن شبکه نسخه‌نویسی دارند، و چگونه این اثر در داروهای سرطان با سایر داروها تفاوت دارد.
